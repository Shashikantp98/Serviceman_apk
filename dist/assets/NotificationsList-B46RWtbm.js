import{u as y,b as w,a as k,r,c as L,j as s,H as b,e as S,S as C,f as E,A as h}from"./index-Dsyms-5d.js";const A=()=>{const l=y(),d=w(),{role:f}=k(),[i,_]=r.useState(!0),[m,p]=r.useState([]),n=L("notify-loader"),N=async()=>{var e;n.setLoading(!0);try{const o=await h.post("/user/listNotificationForCustomer",{});p(o.data||[])}catch(o){console.error("Error:",o)}finally{n.setLoading(!1),_(!1),(e=d.state)!=null&&e.scrollPosition&&setTimeout(()=>{window.scrollTo({top:d.state.scrollPosition,behavior:"instant"})},50)}};r.useEffect(()=>{N()},[]);const j=async(e,o)=>{const g=window.scrollY,{notify_type:u,booking_id:x,support_id:v,_id:t}=e;if(t&&!e.is_seen&&h.post("/user/markNotificationsAsSeen",{notification_id:t}).then(()=>{console.log(`Notification ${t} marked as seen`),p(a=>a.map(c=>c._id===t?{...c,is_seen:!0}:c))}).catch(a=>console.error("Error marking notification as seen:",a)),u==="booking"&&x){l(`/CustomerProjectinfo/${x}`,{state:{fromNotifications:!0,scrollPosition:g,itemIndex:o}});return}if(u==="support"&&v){l("/supportlist");return}console.warn("Unknown notification type:",e)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"customer_header_none"}),f==="customer"?s.jsx(b,{}):s.jsx(S,{}),s.jsxs("div",{className:f==="customer"?"container main-content pt-2":"container main-content-service",children:[s.jsx("div",{className:"fixed_header text-center",children:s.jsx("h1",{className:"head4",children:"Notifications"})}),s.jsxs("div",{className:"row px-2 mb-5 pb-5 fixed_header_padding",children:[s.jsx(C,{show:n.loading,size:"medium",text:"Loading notifications...",overlay:!0}),i&&s.jsx("div",{className:"col-12 text-center pt-5 fixed_header_padding",children:s.jsx("div",{className:"loader"})}),!i&&m.length===0&&s.jsxs("div",{className:"col-12 text-center mt-5 fixed_header_padding",children:[s.jsx("h1",{className:"bigemj",children:"ðŸ‘¨ðŸ¼â€ðŸ¦¯"}),s.jsx("p",{children:"No notifications found"})]}),!i&&m.map((e,o)=>s.jsx("div",{className:"col-12 mt-2",children:s.jsxs("div",{className:"nofi_cards",onClick:()=>j(e,o),style:{cursor:e.notify_type==="booking"&&e.booking_id||e.notify_type==="support"&&e.support_id?"pointer":"default"},children:[s.jsxs("p",{className:"notification_main_title",children:[e.title||"Notification",!e.is_seen&&s.jsx("span",{className:"new_notifications",children:"New"})]}),s.jsx("p",{className:`notfication_messages ${e.is_seen?"":"new_message"}`,children:e.message}),s.jsxs("p",{className:"notification_date_time",children:[s.jsx(E,{size:14}),new Date(e.created_on).toLocaleString()]})]})},o))]})]})]})};export{A as default};
